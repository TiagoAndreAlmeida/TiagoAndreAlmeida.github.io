<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src='js/classes.js'></script>
		<title>Tank War!</title>
		<meta charset='utf-8'>
		<style type="text/css">
			#canvas{
				background: black;
			}
		</style>
	</head>
	<body>
		<canvas id='canvas'></canvas>
		<script type="text/javascript">
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');

			var player = new Tank(1, canvas.height /2);
			var shoots_prefab = [];
			//var shoot = new Shoot(0,0);

			var up = false;
			var down = false;
			var space = false;

			document.addEventListener('keydown', keydown, false);
			document.addEventListener('keyup', keyup, false);

			function keydown (e){
				if(e.keyCode == 38){
					up = true;
				}else if(e.keyCode == 40){
					down = true;
				}
				if(e.keyCode == 32)
					space = true;
			}

			function keyup (e){
				if(e.keyCode == 38){
					up = false;
				}else if(e.keyCode == 40){
					down = false;
				}
				if(e.keyCode == 32)
					space = false;
			}

			function update (){
				ctx.clearRect(0,0,canvas.width,canvas.height);

				if(space){
					aux = new Shoot(player.x+player.width, player.y);
					shoots_prefab.push(aux);
				}

				for(s in shoots_prefab){
					ctx.beginPath();
					ctx.rect(shoots_prefab[s].x, shoots_prefab[s].y, shoots_prefab[s].width, shoots_prefab[s].height);
					ctx.fillStyle = '#ABD435'
					ctx.fill();
					ctx.closePath();
					shoots_prefab[s].move();
					if(shoots_prefab[s].x > canvas.width){
						shoots_prefab.splice(s, 1);
					}
				}
				
				ctx.beginPath();
				ctx.rect(player.x, player.y, player.width, player.height);
				ctx.fillStyle = '#ABD435'
				ctx.fill();
				ctx.closePath();
				if(up || down)
					player.move(up, down);

				requestAnimationFrame(update);
			}
			
			update();
			//setInterval(update, 10);
		</script>
	</body>
</html>